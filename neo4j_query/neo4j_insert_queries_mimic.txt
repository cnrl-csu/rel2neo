LOAD CSV WITH HEADERS FROM 'file:///PATIENT.csv' AS line CREATE(:PATIENT{SUBJECT_ID:toInteger(line.SUBJECT_ID),EXPIRE_FLAG:toInteger(line.EXPIRE_FLAG),GENDER:line.GENDER,DOB:line.DOB,DOD:line.DOD,DOD_HOSP:line.DOD_HOSP,DOD_SSN:line.DOD_SSN});
CREATE INDEX ON:PATIENT(SUBJECT_ID);
LOAD CSV WITH HEADERS FROM 'file:///ADMISSION.csv' AS line CREATE(:ADMISSION{HADM_ID:toInteger(line.HADM_ID),HOSPITAL_EXPIRE_FLAG:toInteger(line.HOSPITAL_EXPIRE_FLAG),HAS_CHARTEVENTS_DATA:toInteger(line.HAS_CHARTEVENTS_DATA),ADMITTIME:line.ADMITTIME,DISCHTIME:line.DISCHTIME,DEATHTIME:line.DEATHTIME,ADMISSION_TYPE:line.ADMISSION_TYPE,ADMISSION_LOCATION:line.ADMISSION_LOCATION,DISCHARGE_LOCATION:line.DISCHARGE_LOCATION,INSURANCE:line.INSURANCE,LANGUAGE:line.LANGUAGE,RELIGION:line.RELIGION,MARITAL_STATUS:line.MARITAL_STATUS,ETHNICITY:line.ETHNICITY,EDREGTIME:line.EDREGTIME,EDOUTTIME:line.EDOUTTIME,DIAGNOSIS:line.DIAGNOSIS});
CREATE INDEX ON:ADMISSION(HADM_ID);
LOAD CSV WITH HEADERS FROM 'file:///ADMIT.csv' AS line MATCH(x1:PATIENT{SUBJECT_ID:line.SUBJECT_ID}),(x2:ADMISSION{HADM_ID:toInteger(line.HADM_ID)}) CREATE(x1)-[:ADMIT{ADMITTIME:line.ADMITTIME,DISCHTIME:line.DISCHTIME,DEATHTIME:line.DEATHTIME,EDREGTIME:line.EDREGTIME,EDOUTTIME:line.EDOUTTIME}]->(x2);
LOAD CSV WITH HEADERS FROM 'file:///ICUSTAY.csv' AS line CREATE(:ICUSTAY{ICUSTAY_ID:toInteger(line.ICUSTAY_ID),FIRST_WARDID:toInteger(line.FIRST_WARDID),LAST_WARDID:toInteger(line.LAST_WARDID),LOS:toFloat(line.LOS),DBSOURCE:line.DBSOURCE,FIRST_CAREUNIT:line.FIRST_CAREUNIT,LAST_CAREUNIT:line.LAST_CAREUNIT,INTIME:line.INTIME,OUTTIME:line.OUTTIME});
CREATE INDEX ON:ICUSTAY(ICUSTAY_ID);
LOAD CSV WITH HEADERS FROM 'file:///ADMIT_ICU.csv' AS line MATCH(x1:ICUSTAY{ICUSTAY_ID:toInteger(line.ICUSTAY_ID)}),(x2:ADMISSION{HADM_ID:toInteger(line.HADM_ID)}) CREATE(x1)-[:ADMIT_ICU{INTIME:line.INTIME,OUTTIME:line.OUTTIME}]->(x2);
LOAD CSV WITH HEADERS FROM 'file:///DRGCODE.csv' AS line CREATE(:DRGCODE{DRGCODE_ID:toInteger(line.DRGCODE_ID),DRG_CODE:toInteger(line.DRG_CODE),DRG_TYPE:line.DRG_TYPE,DESCRIPTION:line.DESCRIPTION,DRG_SEVERITY:line.DRG_SEVERITY,DRG_MORTALITY:line.DRG_MORTALITY});
CREATE INDEX ON:DRGCODE(DRGCODE_ID);
LOAD CSV WITH HEADERS FROM 'file:///ADMIT_DRUG.csv' AS line MATCH(x1:DRGCODE{DRGCODE_ID:toInteger(line.DRGCODE_ID)}),(x2:ADMISSION{HADM_ID:toInteger(line.HADM_ID)}) CREATE(x1)-[:ADMIT_DRUG]->(x2);
LOAD CSV WITH HEADERS FROM 'file:///SERVICE.csv' AS line CREATE(:SERVICE{SERVICE_ID:toInteger(line.SERVICE_ID),TRANSFERTIME:line.TRANSFERTIME,PREV_SERVICE:line.PREV_SERVICE,CURR_SERVICE:line.CURR_SERVICE});
CREATE INDEX ON:SERVICE(SERVICE_ID);
LOAD CSV WITH HEADERS FROM 'file:///ADMIT_SERVICE.csv' AS line MATCH(x1:SERVICE{SERVICE_ID:toInteger(line.SERVICE_ID)}),(x2:ADMISSION{HADM_ID:toInteger(line.HADM_ID)}) CREATE(x1)-[:ADMIT_SERVICE{TRANSFERTIME:line.TRANSFERTIME}]->(x2);
LOAD CSV WITH HEADERS FROM 'file:///a_PRESCRIPTION.csv' AS line CREATE(:PRESCRIPTION{PRES_ID:toInteger(line.PRES_ID),STARTDATE:line.STARTDATE,ENDDATE:line.ENDDATE,DRUG_TYPE:line.DRUG_TYPE,DRUG:line.DRUG,DRUG_NAME_POE:line.DRUG_NAME_POE,DRUG_NAME_GENERIC:line.DRUG_NAME_GENERIC,FORMULARY_DRUG_CD:line.FORMULARY_DRUG_CD,GSN:line.GSN,NDC:line.NDC,PROD_STRENGTH:line.PROD_STRENGTH,DOSE_VAL_RX:line.DOSE_VAL_RX,DOSE_UNIT_RX:line.DOSE_UNIT_RX,FORM_VAL_DISP:line.FORM_VAL_DISP,FORM_UNIT_DISP:line.FORM_UNIT_DISP,ROUTE:line.ROUTE});
CREATE INDEX ON:PRESCRIPTION(PRES_ID);
LOAD CSV WITH HEADERS FROM 'file:///a_ADMIT_PRESCRIPTION.csv' AS line MATCH(x1:PRESCRIPTION{PRES_ID:toInteger(line.PRES_ID)}),(x2:ADMISSION{HADM_ID:toInteger(line.HADM_ID)}) CREATE(x1)-[:ADMIT_PRESCRIPTION{STARTDATE:line.STARTDATE,ENDDATE:line.ENDDATE}]->(x2);
LOAD CSV WITH HEADERS FROM 'file:///b_PRESCRIPTION.csv' AS line CREATE(:PRESCRIPTION{PRES_ID:toInteger(line.PRES_ID),STARTDATE:line.STARTDATE,ENDDATE:line.ENDDATE,DRUG_TYPE:line.DRUG_TYPE,DRUG:line.DRUG,DRUG_NAME_POE:line.DRUG_NAME_POE,DRUG_NAME_GENERIC:line.DRUG_NAME_GENERIC,FORMULARY_DRUG_CD:line.FORMULARY_DRUG_CD,GSN:line.GSN,NDC:line.NDC,PROD_STRENGTH:line.PROD_STRENGTH,DOSE_VAL_RX:line.DOSE_VAL_RX,DOSE_UNIT_RX:line.DOSE_UNIT_RX,FORM_VAL_DISP:line.FORM_VAL_DISP,FORM_UNIT_DISP:line.FORM_UNIT_DISP,ROUTE:line.ROUTE});
CREATE INDEX ON:PRESCRIPTION(PRES_ID);
LOAD CSV WITH HEADERS FROM 'file:///b_ICU_PRESCRIPTION.csv' AS line MATCH(x1:PRESCRIPTION{PRES_ID:toInteger(line.PRES_ID)}),(x2:ICUSTAY{ICUSTAY_ID:toInteger(line.ICUSTAY_ID)}) CREATE(x1)-[:ICU_PRESCRIPTION{STARTDATE:line.STARTDATE,ENDDATE:line.ENDDATE}]->(x2);
